---
title: 爱奇艺视频广告流量分析
categories:
  - 网络流量分析
tags:
  - 网络流量分析
copyright: true
url: 253.html
id: 253
abbrlink: 7270ded8
date: 2017-09-13 23:32:04
---

按照老师教的步骤，在wifi环境下抓安卓端的爱奇艺app的数据包，并从中分析出广告的流量。 三生三世十里桃花01 首先进行tcp会话的统计，我比较喜欢把rel start和duration两栏拉长： 先按照数据量排序： ![](https://i.loli.net/2017/09/13/59b9519bf02ab.png) 好像看不出什么来，老师的经验之谈是高清的视频1s大概100kb。

<!-- more -->

> 获得的高清感观标准：720p、1080p，数据密度：0.25-0.35及以上，那么码率大致在5Mb/10Mb及以上，代表性作品，各高清小组的BD720p/BD1080p 。 获得的标清感观标准：a480p、480p，数据密度：0.12-0.18及以上，那么码率大致在1200-2500kbps，代表性作品，各小组的BDRip/DVDRip .

结合数据量和开始时间一起看前几个： ![](https://ooo.0o0.ooo/2017/09/13/59b951ef96f7d.png) 数据量第一的是在48s开始的，而且48s左右开始的连接特别多。整个过程中48s和84s是两个集中的爆发点，在1s内会有大概三四十个连接开启。 如果结合IO流量图，也可以看出些端倪： ![](https://i.loli.net/2017/09/13/59b952d80cd45.png) 可以看出数据较为集中的地方有三处，第一处是0-8s。我怀疑这其中就有广告。所以再按开始时间排序，找数据量较大的。 ![](https://i.loli.net/2017/09/13/59b9537c84ae7.png) 发现一个规律，一般视频流量，都是数据量较大（不一定是最大），但持续时间很短的。在把0-8s中的4个1Mb以上的流量一一跟踪之后，找到了： ![](https://i.loli.net/2017/09/13/59b954d3940ef.png) 这个请求get了一个f4v的视频片段，下载下来发现是15s，这个请求开始于7s，也就是22s左右结束。假设是在48s开始正式加载视频，那说明前面应该还有一两个15s的广告。继续找22s左右的。 这里出了一个意外，一个5.6s开始的900k的流量也是一个15s的视频。这下子好了，从6s开始，已经有了30s的广告储备了。在27s又发现一个15s的视频。然后就要到48s的正式视频传输了。

广告开始时间(s)

数据量(b)

5.7

942k

7.3

1621k

27.8

1625k

今天先这样，明天再看看别的数据包，找找规律。 震惊！实际播放中竟然看到了4段广告，我找漏了一个！可能是我第一次找广告没什么经验吧。